# Ø§Ø³Ù… Ø§Ù„Ù€ Workflow Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¸Ù‡Ø± ÙÙŠ ØµÙØ­Ø© Actions Ø¹Ù„Ù‰ GitHub
name: 'ÙØ­Øµ ÙˆØ¥ØµÙ„Ø§Ø­ Ø¬ÙˆØ¯Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨ (WordPress)'

# Ù…ØªÙ‰ ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø±
on:
  push:
    branches:
      - main

# Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªÙŠ Ø³ÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡Ø§
jobs:
  fix-code-style:
    name: 'Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¯'
    runs-on: ubuntu-latest
    steps:
      # Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø¬Ù„Ø¨ Ù†Ø³Ø®Ø© Ù…Ù† ÙƒÙˆØ¯ Ø§Ù„Ù‚Ø§Ù„Ø¨
      - name: 'Checkout code'
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      # Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ÙŠØ¦Ø© Ø¹Ù…Ù„ PHP Ù…Ø¹ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
      - name: 'Setup PHP'
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.0'
          tools: composer, phpcs

      # Ø§Ù„Ø®Ø·ÙˆØ© 3: ØªØ«Ø¨ÙŠØª Ù…Ø¹Ø§ÙŠÙŠØ± ÙˆÙˆØ±Ø¯Ø¨Ø±ÙŠØ³ Ø¹Ø¨Ø± Composer
      - name: 'Install WordPress Coding Standards'
        run: |
          composer init --quiet --no-interaction --name="alam-al-anika/ci-tools"
          composer config --no-plugins allow-plugins.dealerdirect/phpcodesniffer-composer-installer true
          composer require --dev wp-coding-standards/wpcs dealerdirect/phpcodesniffer-composer-installer

      # Ø§Ù„Ø®Ø·ÙˆØ© 4: ØªØ´ØºÙŠÙ„ Ø£Ø¯Ø§Ø© Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
      - name: 'Run Auto-Fixer (phpcbf)'
        # ====> Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø®ÙŠØ± <====
        # ØªØ¬Ø§Ù‡Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø£Ø¯Ø§Ø© Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø®Ø·ÙˆØ§Øª
        continue-on-error: true
        run: |
          ./vendor/bin/phpcbf . --standard=WordPress --ignore=*/vendor/*,*/node_modules/*,*/assets/js/*

      # Ø§Ù„Ø®Ø·ÙˆØ© 5: Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹
      - name: 'Commit changes'
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: 'ðŸŽ¨ Chore: Ø¥ØµÙ„Ø§Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¯'
          commit_user_name: 'GitHub Actions Bot'
          commit_user_email: 'github-actions[bot]@users.noreply.github.com'
          commit_author: 'GitHub Actions Bot <github-actions[bot]@users.noreply.github.com>'
