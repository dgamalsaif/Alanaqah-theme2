 # اسم الـ Workflow الذي سيظهر في صفحة Actions على GitHub
name: 'WordPress Theme Check'

# متى يتم تشغيل هذا الأمر
on:
  push:
    branches:
      - main # يتم التشغيل عند أي تحديث لفرع main
  pull_request:
    branches:
      - main # يتم التشغيل عند أي طلب دمج لفرع main

# المهام التي سيتم تنفيذها
jobs:
  # المهمة الأولى: فحص القالب باستخدام أداة Theme Check محدّثة
  theme-check:
    name: 'Theme Check'
    runs-on: ubuntu-latest # استخدام أحدث نسخة من نظام أوبنتو لتشغيل الأمر

    steps:
      # الخطوة 1: جلب نسخة من كود القالب إلى بيئة العمل
      - name: 'Checkout code'
        uses: actions/checkout@v4

      # الخطوة 2: تشغيل أداة فحص القوالب الرسمية (بإصدار أحدث وموثوق)
      - name: 'Run Theme Check Action'
        uses: calvin-l/action-wordpress-theme-check@v1.1
        with:
          # اكتب هنا اسم مجلد القالب الخاص بك
          theme_name: 'alam-al-anika'

  # المهمة الثانية: فحص جودة الكود البرمجي (PHP) مع تثبيت المعايير
  php-codesniffer:
    name: 'PHP Code Sniffer'
    runs-on: ubuntu-latest

    steps:
      # الخطوة 1: جلب نسخة من كود القالب
      - name: 'Checkout code'
        uses: actions/checkout@v4
      
      # الخطوة 2: إعداد بيئة عمل PHP
      - name: 'Setup PHP'
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.0' # يمكنك تحديد إصدار PHP المناسب

      # الخطوة 3: تثبيت معايير ووردبريس باستخدام Composer
      - name: 'Install WordPress Coding Standards'
        run: |
          composer create-project wp-coding-standards/wpcs --no-dev
          sudo phpcs --config-set installed_paths $(pwd)/wpcs

      # الخطوة 4: تشغيل أداة فحص جودة الكود
      - name: 'Run PHP_CodeSniffer'
        run: |
          phpcs . --standard=WordPress --ignore=*/vendor/*,*/node_modules/*
