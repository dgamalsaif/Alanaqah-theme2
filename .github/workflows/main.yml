name: WordPress Theme Validation

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]

jobs:
  theme-validation:
    runs-on: ubuntu-latest
    
    steps:
    - name: ุชุญููู ุงูููุฏ ูู ุงููุณุชูุฏุน
      uses: actions/checkout@v3

    - name: ุงูุชุญูู ูู ุงููููู ุงูุฃุณุงุณู
      run: |
        echo "๐ ุงูุชุญูู ูู ูููู ุงููุงูุจ ุงููุชูุงูู..."
        
        # ุงููููุงุช ุงูุฃุณุงุณูุฉ ุงูุฅูุฒุงููุฉ
        REQUIRED_FILES=("style.css" "index.php" "functions.php")
        for file in "${REQUIRED_FILES[@]}"; do
          if [ ! -f "$file" ]; then
            echo "โ ููู ุฅูุฒุงูู ุบูุฑ ููุฌูุฏ: $file"
            exit 1
          fi
          echo "โ ููุฌูุฏ: $file"
        done

    - name: ูุญุต ูููุงุช JavaScript ุงูุฃุณุงุณูุฉ
      run: |
        echo "๐ ูุญุต ูููุงุช JavaScript..."
        
        # ุงูุจุญุซ ุนู ุฌููุน ูููุงุช JavaScript
        JS_FILES=$(find . -name "*.js" -not -path "./.github/*" 2>/dev/null || true)
        
        if [ -z "$JS_FILES" ]; then
          echo "โช ูู ูุชู ุงูุนุซูุฑ ุนูู ุฃู ูููุงุช JavaScript"
          exit 0
        fi
        
        echo "๐ ุนุฏุฏ ูููุงุช JavaScript ุงูููุฌูุฏุฉ: $(echo "$JS_FILES" | wc -l)"
        echo "๐ ูุงุฆูุฉ ูููุงุช JavaScript:"
        echo "$JS_FILES"

    - name: ูุญุต ุงูููุชุจุงุช ุจุฏูู npm
      run: |
        echo "๐ ุงูุจุญุซ ุนู ุงูููุชุจุงุช ุงูุดุงุฆุนุฉ ุจุฏูู npm..."
        
        LIBRARIES=("jquery" "react" "vue" "axios" "lodash" "bootstrap" "swiper" "gsap")
        for lib in "${LIBRARIES[@]}"; do
          if grep -r -i "$lib" . --include="*.js" --include="*.php" --exclude-dir=.git 2>/dev/null; then
            echo "โ ููุฌูุฏุฉ: $lib"
          else
            echo "โช ุบูุฑ ููุฌูุฏุฉ: $lib"
          fi
        done

    - name: ูุญุต ุฌูุฏุฉ JavaScript ุงูุฃุณุงุณู
      run: |
        echo "๐๏ธ ูุญุต ุฌูุฏุฉ ููุฏ JavaScript ุงูุฃุณุงุณู..."
        
        JS_FILES=$(find . -name "*.js" -not -path "./.github/*" 2>/dev/null || true)
        
        for js_file in $JS_FILES; do
          echo "๐ ูุญุต ููู: $(basename "$js_file")"
          
          # ูุญุต ุจุณูุท ููุฃุฎุทุงุก ุงูุดุงุฆุนุฉ
          if grep -q "console.log" "$js_file"; then
            echo "โ๏ธ  ูุญุชูู ุนูู console.log"
          fi
          
          # ูุญุต ุงูุฃุญุฌุงู
          size=$(wc -c < "$js_file" 2>/dev/null || echo "0")
          if [ "$size" -gt 100000 ]; then
            echo "๐ ุญุฌู ุงูููู: $((size/1000)) KB (ูุจูุฑ)"
          else
            echo "๐ ุญุฌู ุงูููู: $((size/1000)) KB"
          fi
        done

    - name: ูุญุต ููููุงุช ุงููุงูุจ ุงููุชูุฏูุฉ
      run: |
        echo "๐ ุงูุจุญุซ ุนู ููููุงุช ูุชูุฏูุฉ..."
        
        # ุงูุจุญุซ ุนู Slider
        SLIDER_FILES=$(grep -l -i "slider\|carousel" *.php 2>/dev/null || true)
        if [ -n "$SLIDER_FILES" ]; then
          echo "๐ ูููุงุช ุชุญุชูู ุนูู Slider:"
          echo "$SLIDER_FILES"
        else
          echo "โช ูู ูุชู ุงูุนุซูุฑ ุนูู ูููู Slider"
        fi
        
        # ุงูุจุญุซ ุนู Hero section
        HERO_FILES=$(grep -l -i "hero\|banner" *.php 2>/dev/null || true)
        if [ -n "$HERO_FILES" ]; then
          echo "๐ฆธ ูููุงุช ุชุญุชูู ุนูู Hero:"
          echo "$HERO_FILES"
        else
          echo "โช ูู ูุชู ุงูุนุซูุฑ ุนูู ูููู Hero"
        fi

    - name: ูุญุต ุงูุฃููุงู ูุงูุชุตููู
      run: |
        echo "๐จ ูุญุต ูุธุงู ุงูุฃููุงู..."
        
        CSS_FILES=$(find . -name "*.css" -not -path "./.github/*" 2>/dev/null || true)
        if [ -n "$CSS_FILES" ]; then
          echo "๐ ุงูุฃููุงู ุงููุณุชุฎุฏูุฉ:"
          grep -h -E -i "(#([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})|rgb\(|rgba\(|hsl\()" $CSS_FILES 2>/dev/null | \
          sort | uniq | head -10 || echo "โช ูุง ุชูุฌุฏ ุฃููุงู ูุญุฏุฏุฉ"
        else
          echo "โช ูุง ุชูุฌุฏ ูููุงุช CSS"
        fi

    - name: ุชูุฑูุฑ ููุงุฆู
      run: |
        echo "๐ ุชู ุงูุงูุชูุงุก ูู ุงููุญุต!"
        echo "๐ ุงููุชุงุฆุฌ ูุชุงุญุฉ ุฃุนูุงู"
        echo "โ ูุง ุญุงุฌุฉ ูู Node.js ุฃู npm"
